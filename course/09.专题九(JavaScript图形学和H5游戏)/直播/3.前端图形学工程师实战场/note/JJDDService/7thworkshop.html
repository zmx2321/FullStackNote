<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>7#è½¦é—´</title>
    <link rel="stylesheet" href="./css/bootstrap.css" />
    <link rel="stylesheet" href="./css/base.css" />
    <link rel="stylesheet" href="./css/annotation-style.css" />
    <link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon" />
    <link rel="icon" href="./img/favicon.ico" />
  </head>

  <body>
    <!--é¡¶éƒ¨-->
    <header class="header left" id="js-ann-header">
      <div class="left nav">
        <ul>
          <li class="nav_active navTime">
            <!-- <a href="">2019/01/26 æ˜ŸæœŸå…­ æ™´ -7åˆ°5åº¦</a>  -->
            <a id="js-time"></a>
          </li>
        </ul>
      </div>
      <div class="header_center left">
        <div class="jlogo clearfix">
          <div class="jlogoImg"><img src="img/jlogo.png" /></div>
          <p class="jtitle">ç²¾è¿›ç”µåŠ¨èæ³½å·¥å‚æ•°æ®æœåŠ¡å¹³å°</p>
        </div>
      </div>
      <div class="right connav text_right btn-group ">
        <a
          class="nav_active btn btn-default dropdown-toggle"
          data-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="true"
        >
          <i class="nav_3"></i>7#è½¦é—´ <span class="caret"></span>
        </a>
        <ul class="navUl dropdown-menu">
          <li><a href="index.html">å·¥å‚æ¦‚è§ˆ</a></li>
        </ul>
      </div>
    </header>
    <!--å†…å®¹éƒ¨åˆ†-->
    <div class="con left">
      <!--æ•°æ®æ€»æ¦‚-->
      <div class="con_div" id="js-ann-condiv">
        <div class="con_div_text left textLeft">
          <div class="con_div_text02 clearfix con_div_textse">
            <!-- <div class="textpeople"> -->
            <img src="img/ry.png" class="left text01_img" />
            <div class="left text01_div">
              <p>äººå‘˜åœ¨å²—æ•°</p>
              <p class="sky">45</p>
            </div>
            <!-- </div> -->
          </div>
        </div>
        <div class="con_div_text left textLeft">
          <div class="con_div_text02 clearfix con_div_textse">
            <div class="textpeople">
              <img src="img/cq.png" class="left text01_img" />
              <div class="left text01_div">
                <p>äººå‘˜å‡ºå‹¤ç‡</p>
                <p class="sky">80%</p>
              </div>
            </div>
          </div>
        </div>
        <div class="con_div_text left textLeft">
          <div class="con_div_text02 clearfix con_div_textse">
            <div class="textpeople">
              <img src="img/trend2.png" class="left text01_img" />
              <div class="left text01_div">
                <p>å‘¨è®¾å¤‡ç¨¼åŠ¨ç‡</p>
                <p>80%</p>
              </div>
            </div>
          </div>
        </div>
        <!-- <div class="con_div_text left">
                <div class="con_div_text02 clearfix">
                    <img src="img/trend2.png" class="left text01_img" />
                    <div class="left text01_div">
                        <p>å‘¨è®¾å¤‡ç¨¼åŠ¨ç‡</p>
                        <p>80%</p>
                    </div>
                </div>
            </div> -->
      </div>
      <!--ç»Ÿè®¡åˆ†æå›¾-->
      <div class="div_any">
        <div class="divanyInfo">
          <div class="left div_any01" id="js-ann-any01">
            <div class="div_any_child childSeven">
              <div class="div_any_title">
                <img src="img/ss.png" />è½¦é—´å®æ—¶äº§é‡
              </div>
              <p id="js-alive" class="p_chartp p-3"></p>
            </div>
          </div>
          <div class="div_any02 left">
            <div class="div_any_child div_height" style="text-align:center;">
              <div class="div_any_title any_title_width">
                <img src="img/title_3.png" />è½¦é—´3Dæ¨¡å‹å±•ç¤º
              </div>
              <!-- <div id="map_div"> -->
              <canvas id="myCanvas" style="height:98%;width:98%"></canvas>
              <!-- </div> -->
            </div>
          </div>
          <div class="right div_any01">
            <div class="div_any_child childSeven">
              <div class="div_any_title">
                <img src="img/title_4.png" />è´¨é‡è¶‹åŠ¿å›¾
              </div>
              <p id="js-trend" class="p_chart p-3"></p>
            </div>
            <!-- <div class="div_any_child div_any_child_order">
                        <div class="div_any_title"><img src="img/title_5.png">é¥¼å›¾</div>
                        <p id="char4" class="p_chart"></p>
                    </div> -->
          </div>
        </div>
      </div>
      <!--åˆ†æè¡¨æ ¼-->
      <div class="div_table">
        <div class="left div_table_box">
          <div class="div_any_child div_any_child_table">
            <div class="div_any_title"><img src="img/sb.png" />è®¾å¤‡ç»¼åˆ</div>
            <p id="js-multiple" style="padding-top:3%" class="p_chartp p-3"></p>
          </div>
        </div>
        <div class="left div_table_box tableBoxnum">
          <div class="div_any_child div_any_child_table">
            <div class="div_any_title"><img src="img/rw.png" />å‘¨ç”Ÿäº§ä»»åŠ¡</div>
            <div class="table_p">
              <table>
                <thead>
                  <tr>
                    <th>äº§çº¿</th>
                    <th>è®¢å•æ€»æ•°</th>
                    <th>å·²å®Œæˆ</th>
                  </tr>
                </thead>
                <tbody id="js-tasks"></tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="left div_table_box tableBoxnum">
          <div class="div_any_child div_any_child_table">
            <div class="div_any_title">
              <img src="img/gz.png" />è®¾å¤‡æ•…éšœä¿¡æ¯
            </div>
            <div class="table_p">
              <table>
                <thead>
                  <tr>
                    <th>äº§çº¿</th>
                    <th>è®¾å¤‡åç§°</th>
                    <th>æ•…éšœæè¿°</th>
                    <th>å½“å‰çŠ¶æ€</th>
                  </tr>
                </thead>
                <tbody id="js-equfail"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
    <script src="./js/jquery/jquery.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="./js/echarts.min.js"></script>
    <script src="./js/common.js"></script>
    <script src="./js/workshop.js"></script>
    <script src="./js/xeogl.js"></script>
    <script src="./js/glTFModel.js"></script>
    <script src="./js/config.js"></script>
    <script src="./js/annotations/pin.js"></script>
    <script src="./js/annotations/annotation.js"></script>
    <script>
      var scene = new xeogl.Scene({
        transparent: true,
        canvas: document.getElementById('myCanvas'),
      });
      xeogl.setDefaultScene(scene);
      var camera = scene.camera;
      camera.orbitPitch(20);
      var femaleModel = new xeogl.GLTFModel({
        id: 'femaleModel',
        src: './models/7thWorkshopModelV2/7thWorkshopModelV2.gltf',
      });
      var cameraOuterFlight = new xeogl.CameraFlightAnimation({
        fit: true,
        fitFOV: 57,
      });
      var cameraFlight = new xeogl.CameraFlightAnimation();
      //æ‰€æœ‰æ°”æ³¡æ˜¾å¼
      var annotations = [];
      femaleModel.on('loaded', function() {
        cameraOuterFlight.flyTo(femaleModel.scene);
      });
      var cameraControl = new xeogl.CameraControl({
        panToPointer: true,
        pivoting: true,
      });
      var input = scene.input;
      cameraControl.on('hoverEnter', function(hit) {
        var flag = highlightArr.indexOf(hit.mesh.id);
        if (flag < 0) {
          hit.mesh.highlighted = true;
        }
      });
      cameraControl.on('hoverOut', function(hit) {
        hit.mesh.highlighted = false;
      });
      var annotation;
      function createAnnotation(
        { title = 'æš‚æ— æ•°æ®', desc = 'æš‚æ— æ•°æ®è¯·è¡¥å……' },
        hit,
      ) {
        annotation = new xeogl.Annotation({
          mesh: hit.mesh.id,
          primIndex: hit.primIndex,
          bary: hit.bary,
          occludable: true,
          glyph: '1',
          title,
          desc,
          eye: camera.eye,
          look: camera.look,
          up: camera.up,
          pinShown: true,
          labelShown: true,
        });
      }
      //æ‰“å¼€æˆ¿é¡¶
      cameraControl.on('picked', function(hit) {
        // hit = self.scene.pick({
        //     canvasPos: mesh.position,
        //     pickSurface: true,
        //     // excludeMeshes: ['_2398','_2491'],
        //   });
        var mesh = hit.mesh;
        console.log('ğŸ¡æ¨¡å‹id', mesh.id);
        var camera = mesh.scene.camera;
        if (annotation) {
          annotation.destroy();
          annotation = null;
        }
        const info = pronumArr[mesh.id];
        //åªæœ‰æ ‡æ³¨çš„æ‰äº§ç”Ÿæ°”æ³¡
        if (info) {
          if (info.title && info.desc) {
            createAnnotation(info, hit);
          }
        }
        var hideflag = hideArr.indexOf(mesh.id);
        if (hideflag >= 0) {
          mesh.visible = false;
        }
        // console.log(mesh);
        cameraFlight.flyTo(mesh);
      });
      cameraControl.on('pickedNothing', function(hit) {
        cameraOuterFlight.flyTo(femaleModel.scene);
      });
      $(document).on('click', '.xeogl-annotation-title ', function(e) {
        if (annotation) {
          annotation.destroy();
          annotation = null;
        }
        return false;
      });
    </script>
  </body>
</html>
